{% extends 'base.html' %}
{% block content %}
<section class="content">
  <div class="container-fluid">

    <div class="row">
      <div class="col-md-6">
        <div class="card card-primary">
          <div class="card-header"><h3 class="card-title">{{t["upload_image_for_detection"]}}</h3></div>
          <form method="POST" enctype="multipart/form-data">
            <div class="card-body">
              <div class="form-group">
                <label for="image">{{t["select_image"]}}</label>
                <input type="file" name="image" accept="image/*;capture=camera"required class="form-control-file">
              </div>
              <button type="submit" class="btn btn-primary">{{t["detect"]}}</button>
            </div>
          </form>
        </div>

        {% if result %}
        <div class="alert alert-success">
          <strong>Result:</strong> {{ result }}
          <br>
          <strong>Confidence:</strong> {{ confidence }}
        </div>
        {% endif %}
      </div>
                      {% if disease %}
                  <div class="card mt-4">
                    <div class="card-header"><h5>Disease Info</h5></div>
                    <div class="card-body">
                      <p><strong>Description:</strong> {{ disease.description }}</p>
                      <p><strong>Symptoms:</strong> {{ disease.symptoms }}</p>
                      <p><strong>Treatment:</strong> {{ disease.treatment }}</p>
                    </div>
                  </div>
                {% endif %}
                {% if result and not disease %}
                  <div class="alert alert-warning">No detailed information found for <strong>{{ result }}</strong>.</div>
                {% endif %}

      <div class="col-md-6">
        <div class="card card-secondary">
          <div class="card-header"><h3 class="card-title">{{t["detection_logs"]}}</h3></div>
          <div class="card-body">
            {% if logs %}
            <ul class="list-group">
              {% for log in logs %}
              <li class="list-group-item">
                <strong>{{ log.result }}</strong> â€”
                {{ log.timestamp.strftime('%Y-%m-%d %H:%M') }}<br>
                <img src="{{ url_for('static', filename=log.image_path.replace('\\', '/').split('static/')[-1]) }}" height="80">
                <span class="badge badge-success">
                  {{ log.result }} ({{ '%.2f'|format(log.confidence) }}%)
                </span>

              </li>
              
              {% endfor %}
            </ul>
            {% else %}
              <p>No detections yet.</p>
            {% endif %}
          </div>
        </div>

        
      </div>
    </div>

  </div>
</section>
{% endblock %}
